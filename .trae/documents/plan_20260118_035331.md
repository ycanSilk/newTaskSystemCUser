# 修改评论者大厅内容页面

## 1. 任务概述
根据用户需求，我需要修改 `src\app\commenter\hall-content\page.tsx` 页面，保留UI布局和样式，删除内部任务类型定义，增加API调用功能，并创建相应的类型定义文件。

## 2. 实现计划

### 2.1 创建类型定义文件
**文件路径：** `src\app\types\task\getTaskPoolList.ts`

根据API响应示例和页面渲染需求，定义以下类型：
- `TaskPoolListItem`：任务池列表项类型
- `TaskPoolPagination`：任务池分页信息类型
- `TaskPoolListResponseData`：任务池响应数据类型
- `TaskPoolListResponse`：任务池响应类型

### 2.2 修改前端页面
**文件路径：** `src\app\commenter\hall-content\page.tsx`

实现以下功能：
- 删除页面内部现有的 `ApiResponse` 和 `Task` 接口定义
- 从 `src\app\types\task\getTaskPoolList.ts` 导入类型定义
- 修改 `fetchAvailableTasks` 函数，使其调用 `src\app\api\task\getTaskPoolList\route.ts` 中间件
- 调整API请求参数和响应处理逻辑，匹配新的API接口
- 确保页面能正确渲染API返回的任务池数据

### 2.3 验证修改
- 确保页面UI布局和样式保持不变
- 确保API调用功能正常工作
- 确保类型定义正确，没有编译错误

## 3. 技术规范

- 严格遵循 `API_REQUEST_STANDARD.md` 的规范
- 使用TypeScript进行类型定义
- 保留现有的UI布局和样式
- 不做多余修改

## 4. 代码修改示例

### 4.1 类型定义示例
```typescript
// 任务池列表项类型
export interface TaskPoolListItem {
  id: number;
  title: string;
  is_combo: boolean;
  stage: number;
  stage_text: string;
  video_url: string;
  deadline: number;
  deadline_text: string;
  task_count: number;
  task_done: number;
  task_doing: number;
  task_reviewing: number;
  remain_count: number;
  unit_price: number;
  total_price: number;
  status: number;
  created_at: string;
}

// 任务池分页信息类型
export interface TaskPoolPagination {
  page: number;
  limit: number;
  total: number;
  total_pages: number;
}

// 任务池响应数据类型
export interface TaskPoolListResponseData {
  list: TaskPoolListItem[];
  pagination: TaskPoolPagination;
}

// 任务池响应类型
export interface TaskPoolListResponse {
  code: number;
  message: string;
  data: TaskPoolListResponseData;
  timestamp: number;
  success: boolean;
}
```

### 4.2 前端页面修改示例
```typescript
// 删除内部类型定义
// 导入新的类型定义
import { TaskPoolListResponse } from '../../../types/task/getTaskPoolList';

// 修改API调用函数
const fetchAvailableTasks = async (page: number = 0) => {
  setIsLoading(true);
  setError(null);
  
  try {
    // 调用新的API接口
    const response = await fetch(`/api/task/getTaskPoolList?page=${page}&size=10`, {
      method: 'GET',
      credentials: 'include'
    });

    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }

    const responseData: TaskPoolListResponse = await response.json();
    
    if (responseData.success) {
      // 处理返回的数据
      const formattedTasks = responseData.data.list || [];
      setTasks(formattedTasks);
      setTotalItems(responseData.data.pagination.total || 0);
      setTotalPages(responseData.data.pagination.total_pages || 0);
      setCurrentPage(page);
      setLastUpdated(new Date());
    } else {
      throw new Error(responseData.message || '获取任务列表失败');
    }
  } catch (error) {
    // 错误处理
  } finally {
    setIsLoading(false);
  }
};
```

## 5. 注意事项

- 确保API调用的URL和参数正确
- 确保类型定义与API响应格式匹配
- 确保页面渲染逻辑与新的数据结构匹配
- 保留现有的排序、分页、刷新等功能
- 严格遵循`API_REQUEST_STANDARD.md`的规范